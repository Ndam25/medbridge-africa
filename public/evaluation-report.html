<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MedBridge Africa — Rapport d'Évaluation</title>
  <link rel="icon" href="/favicon.ico">
  <style>
    :root { --ink:#0f172a; --muted:#64748b; --brand:#0ea5e9; --bg:#ffffff; --line:#e2e8f0; }
    *{ box-sizing:border-box; }
    body{ margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; color:var(--ink); background:#fff; }
    header, main { max-width: 980px; margin: 0 auto; padding: 16px; }
    header { display:flex; align-items:center; justify-content:space-between; border-bottom:1px solid var(--line); }
    h1 { margin:10px 0 4px; font-size:28px; }
    .grid{ display:grid; grid-template-columns: 1fr 1fr; gap:14px; }
    .card{ border:1px solid var(--line); border-radius:14px; padding:16px; background:#fff; margin:12px 0; }
    .muted{ color:var(--muted); }
    .btn{ display:inline-flex; align-items:center; justify-content:center; padding:10px 14px; border:1px solid var(--line); border-radius:10px; background:#fff; cursor:pointer; font-weight:600; }
    .btn.primary{ background:var(--brand); color:#fff; border-color:var(--brand); }
    @media print{ header nav, .actions { display:none; } body { background: #fff; } }
    @media (max-width:720px){ header, main { padding:12px; } .grid{ grid-template-columns: 1fr; } }
  </style>
  <script>
    const KEY="mba_eval_draft";
    const $=sel=>document.querySelector(sel);
    function loadDraft(){ try{ return JSON.parse(localStorage.getItem(KEY)||"{}"); }catch{return{}} }
    function computeScore(d){
      let s=0;
      s+=Math.min(30,(Number(d.pubs||0))*1.5);
      s+=Math.min(25, Math.log10((Number(d.cites||0))+1)*10);
      s+=Math.min(15, (d.awards?.length?10:0)+(d.reviewing?.length?5:0));
      s+=Math.min(15, (d.leadership?.length?10:0)+(d.media?.length?5:0));
      s+=Math.min(15, Math.min(15, Number(d.years||0)));
      return Math.round(Math.max(0, Math.min(100, s)));
    }
    const STR={ fr:{brand:"MedBridge Africa", title:"Rapport d'Évaluation d'Éligibilité", program:"Programme", contact:"Coordonnées", profile:"Profil académique & expérience", evidence:"Preuves & réalisations", project:"Projet & objectifs US", consent:"Consentement", score:"Score indicatif", actions:"Actions", print:"Imprimer / PDF", back:"Retour au formulaire"},
                en:{brand:"MedBridge Africa", title:"Eligibility Assessment Report", program:"Program", contact:"Contact details", profile:"Academic profile & experience", evidence:"Evidence & achievements", project:"Project & US objectives", consent:"Consent", score:"Indicative score", actions:"Actions", print:"Print / PDF", back:"Back to form"} };
    window.addEventListener("DOMContentLoaded", ()=>{
      const d=loadDraft(); const lang=(d.lang==="en")?"en":"fr"; const S=STR[lang]; document.documentElement.lang=lang;
      $("#brand").textContent=S.brand; $("#title").textContent=S.title;
      $("#program").textContent=d.program||"—"; $("#name").textContent=d.full_name||"—"; $("#email").textContent=d.email||"—";
      $("#phone").textContent=d.phone||"—"; $("#country").textContent=d.country||"—"; $("#field").textContent=d.field||"—";
      $("#highest").textContent=d.highest||"—"; $("#years").textContent=(d.years??"—"); $("#summary").textContent=d.summary||"—";
      $("#pubs").textContent=(d.pubs??"—"); $("#cites").textContent=(d.cites??"—"); $("#awards").textContent=d.awards||"—";
      $("#reviewing").textContent=d.reviewing||"—"; $("#leadership").textContent=d.leadership||"—"; $("#media").textContent=d.media||"—";
      $("#sector").textContent=d.sector||"—"; $("#statecity").textContent=d.statecity||"—"; $("#proj").textContent=d.proj||"—";
      $("#lors").textContent=d.lors||"—"; $("#uspartners").textContent=d.uspartners||"—"; $("#consent").textContent=d.consent?"✓":"—";
      $("#scoreVal").textContent=computeScore(d);
      $("#sec-program").textContent=S.program; $("#sec-contact").textContent=S.contact; $("#sec-profile").textContent=S.profile;
      $("#sec-evidence").textContent=S.evidence; $("#sec-project").textContent=S.project; $("#sec-consent").textContent=S.consent;
      $("#sec-score").textContent=S.score; $("#printBtn").textContent=S.print; $("#backBtn").textContent=S.back;
      document.getElementById("printBtn").addEventListener("click",()=>window.print());
      document.getElementById("backBtn").addEventListener("click",()=>location.href="/evaluation-form.html");
      document.getElementById("langSwitch").addEventListener("click",(e)=>{e.preventDefault(); const next=(lang==="fr")?"en":"fr"; d.lang=next; localStorage.setItem(KEY, JSON.stringify(d)); location.reload();});
      document.getElementById("langSwitch").textContent=(lang==="fr"?"English":"Français");
      document.getElementById("year").textContent=new Date().getFullYear();
    });
  </script>
</head>
<body>
  <header>
    <div id="brand" style="font-weight:700;">MedBridge Africa</div>
    <nav class="actions">
      <a class="btn" href="#" id="langSwitch">English</a>
      <a class="btn" id="printBtn">Imprimer / PDF</a>
      <a class="btn primary" id="backBtn">Retour au formulaire</a>
    </nav>
  </header>

  <main>
    <h1 id="title">Rapport d'Évaluation d'Éligibilité</h1>

    <section class="card">
      <h2 id="sec-program" class="muted">Programme</h2>
      <div><strong id="program">—</strong></div>
    </section>

    <section class="card">
      <h2 id="sec-contact" class="muted">Coordonnées</h2>
      <div class="grid">
        <div><strong>Nom</strong><br><span id="name">—</span></div>
        <div><strong>Email</strong><br><span id="email">—</span></div>
        <div><strong>Téléphone</strong><br><span id="phone">—</span></div>
        <div><strong>Pays</strong><br><span id="country">—</span></div>
        <div style="grid-column:1/-1;"><strong>Domaine</strong><br><span id="field">—</span></div>
      </div>
    </section>

    <section class="card">
      <h2 id="sec-profile" class="muted">Profil académique & expérience</h2>
      <div class="grid">
        <div><strong>Niveau académique</strong><br><span id="highest">—</span></div>
        <div><strong>Années d'expérience</strong><br><span id="years">—</span></div>
      </div>
      <div style="margin-top:8px;"><strong>Résumé</strong><br><span id="summary">—</span></div>
    </section>

    <section class="card">
      <h2 id="sec-evidence" class="muted">Preuves & réalisations</h2>
      <div class="grid">
        <div><strong>Publications</strong><br><span id="pubs">—</span></div>
        <div><strong>Citations</strong><br><span id="cites">—</span></div>
      </div>
      <div style="margin-top:8px;"><strong>Prix / distinctions</strong><br><span id="awards">—</span></div>
      <div style="margin-top:8px;"><strong>Jury / reviewing</strong><br><span id="reviewing">—</span></div>
      <div style="margin-top:8px;"><strong>Leadership</strong><br><span id="leadership">—</span></div>
      <div style="margin-top:8px;"><strong>Médiatisation</strong><br><span id="media">—</span></div>
    </section>

    <section class="card">
      <h2 id="sec-project" class="muted">Projet & objectifs US</h2>
      <div class="grid">
        <div><strong>Secteur</strong><br><span id="sector">—</span></div>
        <div><strong>État / Ville</strong><br><span id="statecity">—</span></div>
      </div>
      <div style="margin-top:8px;"><strong>Résumé du projet</strong><br><span id="proj">—</span></div>
      <div style="margin-top:8px;"><strong>Lettres de recommandation</strong><br><span id="lors">—</span></div>
      <div style="margin-top:8px;"><strong>Partenaires US / faisabilité</strong><br><span id="uspartners">—</span></div>
    </section>

    <section class="card">
      <h2 id="sec-consent" class="muted">Consentement</h2>
      <div><strong>Consentement</strong> : <span id="consent">—</span></div>
    </section>

    <section class="card">
      <h2 id="sec-score" class="muted">Score indicatif</h2>
      <div style="font-size:28px; font-weight:800;"><span id="scoreVal">—</span> / 100</div>
      <p class="muted" style="margin:6px 0 0;">Note : score non contractuel, à visée indicative pour pré-tri EB1-A / EB2-NIW.</p>
    </section>
  </main>

  <footer style="border-top:1px solid #e2e8f0; padding:16px; text-align:center; color:#64748b; font-size:12px;">
    © <span id="year"></span> MedBridge Africa
  </footer>
  <script>document.getElementById("year").textContent = new Date().getFullYear();</script>
</body>
</html>