<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MedBridge Africa — EB-1A / EB-2 NIW Pre-Evaluation Form</title>
  <style>
    body{font-family:Inter,Arial,Helvetica,sans-serif;background:#f8fafc;color:#0f172a;margin:0}
    main{max-width:900px;margin:24px auto;padding:20px}
    h1{color:#0f766e;text-align:center}
    .lead{color:#475569;text-align:center;margin-bottom:18px}
    .card{background:#fff;border:1px solid #e6eef2;padding:18px;border-radius:10px;margin-top:14px}
    h2{margin-top:0}
    label{display:block;font-weight:600;margin-top:10px}
    input,select,textarea{width:100%;padding:8px;border:1px solid #cbd5e1;border-radius:6px;margin-top:6px;box-sizing:border-box}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .actions{text-align:right;margin-top:16px}
    button{background:#0f766e;color:#fff;border:none;padding:10px 16px;border-radius:999px;cursor:pointer;font-weight:700}
    .hint{font-size:0.85rem;color:#64748b;margin-top:4px}
    @media(max-width:640px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <main>
    <h1>EB-1A / EB-2 NIW — Pre-Evaluation (English)</h1>
    <p class="lead">Complete this short form to generate an indicative pre-evaluation report. This is informational and not legal advice.</p>

    <form id="eval-form" class="card" onsubmit="return false;">
      <section>
        <h2>1 — Profile & target</h2>

        <label for="program">Target category</label>
        <select id="program" required>
          <option value="">— select —</option>
          <option value="EB1-A">EB1-A (Extraordinary Ability)</option>
          <option value="EB2-NIW">EB2-NIW (National Interest Waiver)</option>
        </select>

        <div class="grid">
          <div>
            <label for="fullName">Full name</label>
            <input id="fullName" type="text" placeholder="Ex: ADAMA NDIR" required />
          </div>
          <div>
            <label for="email">Email</label>
            <input id="email" type="email" placeholder="you@example.com" required />
          </div>
        </div>

        <div class="grid">
          <div>
            <label for="education">Highest degree</label>
            <select id="education" required>
              <option value="">— select —</option>
              <option value="Bachelor">Bachelor / Licence</option>
              <option value="Master">Master</option>
              <option value="PhD">PhD / Doctorate / Specialty</option>
              <option value="Other">Other</option>
            </select>
          </div>
          <div>
            <label for="years">Years of professional experience</label>
            <input id="years" type="number" min="0" value="0" />
          </div>
        </div>

        <label for="country">Country of practice / residence</label>
        <input id="country" type="text" placeholder="e.g. Senegal" />

        <label for="summary">Short profile summary</label>
        <textarea id="summary" placeholder="Brief description of your role, responsibilities and main achievements (5–8 lines)"></textarea>
      </section>

      <section style="margin-top:12px">
        <h2>2 — Academic & professional indicators</h2>
        <div class="grid">
          <div>
            <label for="pubs">Number of publications</label>
            <input id="pubs" type="number" min="0" value="0" />
            <div class="hint">Include indexed articles, chapters, major technical reports.</div>
          </div>
          <div>
            <label for="cites">Approx. citations</label>
            <input id="cites" type="number" min="0" value="0" />
            <div class="hint">Estimate from Google Scholar / Scopus if available.</div>
          </div>
        </div>

        <label for="awards">Awards / distinctions (count)</label>
        <input id="awards" type="number" min="0" value="0" />
      </section>

      <section style="margin-top:12px">
        <h2>3 — Project & impact (U.S.)</h2>
        <label for="sector">Sector / domain</label>
        <input id="sector" type="text" placeholder="e.g. Public health, AI for health" />

        <label for="location">Planned context / place</label>
        <input id="location" type="text" placeholder="e.g. university collaboration, hospital, program" />

        <label for="project">Project summary</label>
        <textarea id="project" placeholder="Describe the project and expected impact in the U.S. (10–15 lines)"></textarea>
      </section>

      <div class="actions">
        <button id="submit-btn" type="button">Submit and view report</button>
      </div>
    </form>

    <p style="text-align:center;margin-top:14px;color:#64748b;font-size:0.9rem">
      Generated report is indicative — not legal advice. It will be reviewed with a MedBridge Africa advisor.
    </p>
  </main>

  <script>
    (function () {
      function computeScore(data) {
        let score = 0;
        if (data.program === "EB1-A") score += 10; else if (data.program === "EB2-NIW") score += 8;
        switch (data.education) {
          case "Bachelor": score += 5; break;
          case "Master": score += 8; break;
          case "PhD": score += 12; break;
          default: score += 3;
        }
        const years = Number(data.years || 0);
        if (years > 0) score += Math.min(years,20);
        if (years >= 10) score += 5;
        const pubs = Number(data.pubs || 0);
        if (pubs === 0) score += 0;
        else if (pubs <= 2) score += 5;
        else if (pubs <= 5) score += 10;
        else if (pubs <= 10) score += 15;
        else score += 20;
        const cites = Number(data.cites || 0);
        if (cites === 0) score += 0;
        else if (cites <= 50) score += 5;
        else if (cites <= 200) score += 10;
        else score += 15;
        const awards = Number(data.awards || 0);
        if (awards > 0) score += 8;
        const summLen = (data.summary || "").trim().length;
        if (summLen >= 200 && summLen < 400) score += 5; else if (summLen >= 400) score += 8;
        const projLen = (data.projectDesc || "").trim().length;
        if (projLen >= 200 && projLen < 400) score += 5; else if (projLen >= 400) score += 8;
        if (score > 100) score = 100;
        return Math.round(score);
      }

      function buildProgramGuess(score) {
        if (score >= 85) return "Very strong EB1-A / EB2-NIW potential.";
        if (score >= 70) return "EB2-NIW potential with elements to strengthen for EB1-A.";
        if (score >= 50) return "Profile in consolidation; EB2-NIW may be realistic in the medium term.";
        return "Initial profile; several elements to develop before EB2-NIW / EB1-A.";
      }

      function buildRecommendations(data, score) {
        const recos = [];
        if ((data.pubs || 0) === 0) recos.push("Increase publications (ideally ≥3–5 indexed articles).");
        else if (data.pubs < 5) recos.push("Continue publishing in peer-reviewed journals to consolidate academic profile.");
        if ((data.awards || 0) === 0) recos.push("Identify/document awards or competitive scholarships to strengthen evidence of excellence.");
        if (!(data.summary || "").trim() || (data.summary || "").trim().length < 200) recos.push("Clarify your role and specific contributions (impact, leadership).");
        if (!(data.projectDesc || "").trim() || (data.projectDesc || "").trim().length < 200) recos.push("Develop your U.S. project plan (beneficiaries, measurable indicators).");
        if (score < 70) recos.push("Plan 12–18 months of visibility: publications, conferences, collaborations.");
        if (recos.length === 0) recos.push("Profile appears structured; fine strategic work still required to align with formal EB criteria.");
        return recos;
      }

      document.getElementById("submit-btn").addEventListener("click", function () {
        const program = (document.getElementById("program").value || "").trim();
        const fullName = (document.getElementById("fullName").value || "").trim();
        const email = (document.getElementById("email").value || "").trim();
        const education = (document.getElementById("education").value || "").trim();
        const years = Number(document.getElementById("years").value || 0);
        const country = (document.getElementById("country").value || "").trim();
        const summary = (document.getElementById("summary").value || "").trim();
        const pubs = Number(document.getElementById("pubs").value || 0);
        const cites = Number(document.getElementById("cites").value || 0);
        const awards = Number(document.getElementById("awards").value || 0);
        const sector = (document.getElementById("sector").value || "").trim();
        const location = (document.getElementById("location").value || "").trim();
        const projectDesc = (document.getElementById("project").value || "").trim();

        if (!program || !fullName || !email) {
          alert("Please provide at least target category, full name and an email.");
          return;
        }

        const rawData = {
          program, fullName, email, education, years, country, summary,
          pubs, cites, awards,
          sector, location, projectDesc
        };

        const score = computeScore({
          program, education, years, pubs, cites, awards,
          summary, projectDesc
        });

        const programGuess = buildProgramGuess(score);
        const recommendations = buildRecommendations(rawData, score);

        const payload = {
          score,
          programGuess,
          profile: {
            fullName,
            email,
            country,
            educationLevel: education,
            yearsExperience: years,
            summary,
            targetProgram: program
          },
          metrics: {
            pubs,
            cites,
            awards
          },
          project: {
            sector,
            place: location,
            summary: projectDesc
          },
          recommendations,
          lang: "en"
        };

        try {
          localStorage.setItem("mba_eval_result_v1", JSON.stringify(payload));
          console.log("[EVAL-EN] Stored:", payload);
        } catch (e) {
          console.warn("Unable to write to localStorage:", e);
          alert("Cannot save data locally in this browser.");
          return;
        }

        alert("Saved — redirecting to your indicative report.");
        window.location.href = "evaluation-report-en.html";
      });
    })();
  </script>
</body>
</html>
